# DNS란?

Domain Name Service의 약자로 도메인에 이름을 적용시키는 서비스이다.

사람에 빗대어 설명하면, 대한민국에 존재하는 100만번째 사람 이라고 하면 굉장히 찾기 어렵다. 만약 DNS를 사용하게 된다면, 홍길동 이라는 이름을 통해 정확하게 찾을 수 있다.

네트워크 통신을 통해 Http 요청을 보내게 되면 해당 서버의 IP로 요청을 보내야 한다. 하지만 구글같은 경우 172.217.31.132의 IP주소를 가지고 있다. 이것을 우리는 172.217.. 이런식으로 외우지 않는다. 클라이언트는 www.google.com 이라는 도메인 주소로 접근한다.

이 www.google.com이 바로 DNS를 이용해서 IP위에 도메인을 씌운 것이다.

---

## DNS는 어떤식으로 동작하나요?

DNS도 DNS서버가 있어야지 동작한다.

우리가 도메인을 사고 그 도메인을 적용시켜서 우리의 111.111... 이런 IP 주소값이 www.myservice.com으로 씌워지듯이 이것을 매핑하는 DNS 서버가 존재한다.

DNS서버는 전 세계에 분산되어있다. 전 세계에 13개 그룹으로 나누어져 있지만, 미러링되어 몇백대 정도 존재한다고 한다. 미국, 유럽, 아시아 등등 대륙에 배치되어 ".com은 어디로 가면되?" 같은 요청을 처리한다.

---

## 도메인 해석 방식

일반적으로 도메인은 www.google.com이 존재한다고 가정할 때, www.google.com의 IP주소를 찾아달라는 요청이 존재하지만, 마냥 이걸로는 단정지을 수 없다.

도메인은 Top Down 형식으로 계층적으로 해석이 된다. 맨 처음 시작할 때 먼저 로컬 PC에 해당 URL의 IP주소가 존재하는지 확인한다. 캐싱되어있는지 여부를 확인 하는 것이다.

캐싱이 되어있다면, 그 IP주소를 사용한다. 하지만 캐싱되어있지 않은 경우 다음 단계로 넘어간다.

다음 단계는, 로컬 DNS 서버에서 확인을 한 번더 한다. 여기에도 캐싱되어 있지 않으면 또 넘어가게 되는 것이다.

다음 단계는, 루트 DNS 즉, 전 세계가 공통으로 처리하는 DNS 루트 서버에 요청한다. 이 서버가 13개의 그룹으로 나뉘어진 DNS 서버이다.

여기서는 .com, .kr, .eu 이런식으로 끝자리의 도메인 규칙을 보고 해당 도메인을 다음 DNS 서버로 안내한다. .com 이라면 가장 가까운 .com DNS 서버가 요청될 것이다. 여기서 잘 이해했다면, .com 다음은 어디로 이어질지 예상 해볼 수 있다.

루트 DNS는 .com을 누가 관리하는지만 알려준다. 루트는 전체 도메인을 알지 못한다. 전체 도메인은 더 세부적인 DNS 서버에서 관리하게 되는 것 이다.

이후에는 .com들을 관리하는 서버에 도착한다. 이걸 .com DNS라고 부를 수 있다. .com DNS에게 이 때 물어보는 것이다. google.com을 누가 관리하는지를.

그렇게 물어보게되면 .com DNS 서버가 google.com을 관리하는 DNS 서버의 위치를 알려줄 것이다.

마지막으로 google.com DNS 서버에 www.google.com의 IP주소를 물어보면, 비로소 실제 IP주소인 172.217.174.100를 응답받게 된다.

이렇게 받아온 IP를 로컬 DNS 서버가 캐시에 저장하고, 클라이언트에게 응답객체로 전달하는 것이다.

여기서 핵심은 DNS 서버는 Top Down 방식으로 세분화 되어있다는 것이다.

---

### DNS 조회 과정 정리

**www.google.com을 조회하는 경우:**

1. **로컬 PC 캐시 확인** - 이전에 방문한 적이 있는지 확인
2. **로컬 DNS 서버 캐시 확인** - ISP DNS 서버에 캐시되어 있는지 확인
3. **루트 DNS 서버** - .com DNS 서버 위치 안내
4. **.com DNS 서버** - google.com DNS 서버 위치 안내
5. **google.com DNS 서버** - www.google.com의 실제 IP 주소 응답
6. **로컬 DNS가 받은 IP를 캐시에 저장**하고 클라이언트에게 전달
