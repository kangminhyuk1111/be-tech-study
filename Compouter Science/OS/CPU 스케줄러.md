# CPU 스케줄러란?

CPU 스케줄러는 프로세스들이 CPU를 공정하게 사용할 수 있도록 관리하는 운영체제의 핵심 요소다.

사람에 빗대어 설명하면, 식당의 요리사라고 생각할 수 있다. 주방에 주문(프로세스)들이 많이 들어오는데, 요리사가 어떤 주문을 먼저 요리할지 결정하는 것처럼, CPU 스케줄러도 많은 프로세스 중에서 누가 CPU를 사용할지 결정한다.

요리사는 한 명이고(CPU), 하지만 주문은 수십 개가 들어온다(프로세스). 주문 중에는 급한 것도 있고, 복잡한 것도 있고, 간단한 것도 있다. 이 모든 주문이 공정하게 처리될 수 있도록 순서를 정하고 요리 시간을 할당하는 것이 CPU 스케줄러의 역할이다.

---

## CPU 스케줄링은 어떤 식으로 동작하나요?

CPU 스케줄러는 프로세스의 상태를 관리하면서 동작한다.

프로세스는 여러 상태를 가진다. Ready 상태(CPU를 기다리는 중), Running 상태(CPU를 사용 중), Waiting 상태(입출력을 기다리는 중) 등이다.

Ready 상태에 있는 프로세스들이 줄을 서 있는 것처럼, CPU 스케줄러는 이 대기열(Queue)에서 프로세스를 꺼내 CPU에 할당한다.

중요한 것은 어떤 기준으로 프로세스를 선택할 것인가이다. 이것을 결정하는 방식을 스케줄링 알고리즘이라고 한다.

---

## 선점형과 비선점형 스케줄링

CPU 스케줄링은 크게 두 가지 방식으로 나뉜다.

**비선점형(Non-Preemptive) 스케줄링**

한 번 요리를 시작한 요리사는 그 요리가 완료될 때까지 다른 요리를 멈추고 시작할 수 없다. 마치 요리사가 스테이크를 구우면서 그 스테이크가 다 구워질 때까지 다른 주문을 할 수 없는 것처럼.

장점은 구현이 간단하고, 요리를 끝까지 집중해서 할 수 있다는 것이다. 하지만 단점은 복잡한 요리(오래 걸리는 프로세스)가 먼저 들어오면 뒤의 간단한 요리(짧은 프로세스)들이 계속 기다려야 한다는 것이다.

**선점형(Preemptive) 스케줄링**

요리사가 현재 요리하던 것을 중단하고 더 급한 주문을 먼저 요리할 수 있다. 마치 요리사가 일반 주문의 반찬을 담고 있다가, VIP 고객의 주문이 들어오면 현재 하던 일을 멈추고 VIP 주문을 먼저 요리하는 것처럼.

장점은 모든 주문(프로세스)이 공정하게 요리 시간을 할당받을 수 있다는 것이다. 하지만 단점은 요리를 자주 중단했다가 다시 시작해야 하므로, 요리사가 계속 "어느 요리를 하던 중이었지?" 라고 확인하는 오버헤드(문맥 교환)가 크다는 것이다.

현대의 운영체제는 대부분 선점형 스케줄링을 사용한다.

---

## CPU 스케줄링의 우선순위

모든 프로세스를 똑같이 취급할 수는 없다. 일부 프로세스는 더 중요하거나, 더 시급하거나, 더 자주 CPU를 사용해야 한다.

이를 위해 우선순위(Priority) 개념이 도입된다.

**우선순위의 필요성**

마치 식당에서 회사 회장님의 주문이 들어오면, 일반 손님의 주문보다 먼저 요리하는 것처럼, 운영체제도 중요한 프로세스(예: 시스템 프로세스)에게 더 높은 우선순위를 부여한다.

**우선순위 결정 방식**

운영체제는 여러 요소를 고려해서 우선순위를 결정한다:
- 프로세스의 종류 (시스템 vs 사용자 프로세스)
- 프로세스의 중요도
- 사용자가 명시적으로 지정한 값
- 프로세스의 대기 시간

예를 들어, 응답성이 중요한 UI 프로세스는 높은 우선순위를 받아서 사용자의 입력에 빠르게 반응할 수 있다.

**우선순위 역전 문제**

요리사가 일반 손님의 주문을 요리하고 있는데, 그 주문에 필요한 재료(자원)를 회사 회장님의 주문에서 사용 중이라면, 회장님의 주문도 기다려야 하는 문제가 발생한다. 이것을 우선순위 역전이라고 한다. 현대 운영체제는 이를 해결하기 위해 일반 손님의 주문이 끝나기 전에 회장님 주문에 필요한 재료를 미리 준비해두는 식의 우선순위 상승 기법을 사용한다.

---

## CPU 스케줄링 알고리즘

실제 CPU 스케줄링은 여러 알고리즘이 존재한다.

**FCFS (First Come First Served)**

먼저 들어온 주문부터 완성할 때까지 끝내는 방식이다. 비선점형이므로 구현은 간단하지만, 복잡한 요리(오래 걸리는 주문)가 먼저 들어오면 뒤의 간단한 요리(짧은 주문)들이 계속 기다려야 한다.

**Round Robin (RR)**

요리사가 각 주문에게 정해진 시간(예: 5분)만큼만 요리하고, 5분이 지나면 다음 주문으로 넘긴다. 선점형이므로 모든 주문이 공정하게 요리 시간을 받지만, 자주 주문을 바꾸므로 요리사의 집중력 전환 비용(문맥 교환)이 발생한다.

**Priority Scheduling**

우선순위가 높은 주문(VIP, 급한 주문)을 먼저 요리한다. 하지만 앞에서 설명한 우선순위 역전 문제가 발생할 수 있다.

**Multilevel Queue**

주방의 여러 구역을 우선순위별로 나누는 방식이다. VIP 주문 구역, 일반 주문 구역, 예약 주문 구역 같이 나누고, VIP 구역부터 먼저 처리한다. 각 구역은 자신의 스케줄링 방식(예: FCFS, Round Robin)을 가질 수 있다.

---

### CPU 스케줄링 과정 정리

**프로세스가 CPU를 할당받는 경우:**

1. **프로세스 생성** - 새로운 프로세스가 생성되어 Ready 큐에 들어감
2. **우선순위 계산** - 운영체제가 우선순위를 계산
3. **큐에서 선택** - 스케줄링 알고리즘에 따라 Ready 큐에서 프로세스 선택
4. **CPU 할당** - 선택된 프로세스를 Running 상태로 변경하고 CPU 할당
5. **시간 경과** - 할당된 시간이 지나거나 프로세스가 입출력 대기 상태로 변경됨
6. **문맥 교환** - 현재 프로세스의 상태를 저장하고, 다음 프로세스를 실행

이렇게 계속 반복되면서 모든 프로세스가 공정하게 CPU를 사용할 수 있게 된다.

---

## 핵심 정리

CPU 스케줄러의 핵심은 **한정된 CPU 자원을 여러 프로세스가 공정하게 사용할 수 있도록 관리**하는 것이다.

선점형과 비선점형, 우선순위, 다양한 알고리즘을 통해 운영체제는 각 상황에 맞는 최적의 스케줄링을 구현한다.
